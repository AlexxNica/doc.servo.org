<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `constellation` mod in crate `constellation`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, constellation">

    <title>constellation::constellation - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../normalize.css">
    <link rel="stylesheet" type="text/css" href="../../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='../index.html'>constellation</a></p><script>window.sidebarCurrent = {name: 'constellation', ty: 'mod', relpath: '../'};</script><script defer src="../sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Module <a href='../index.html'>constellation</a>::<wbr><a class='mod' href=''>constellation</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a class='srclink' href='../../src/constellation/constellation.rs.html#5-2615' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p>The <code>Constellation</code>, Servo&#39;s Grand Central Station</p>

<p>The constellation tracks all information kept globally by the
browser engine, which includes:</p>

<ul>
<li><p>The set of all <code>EventLoop</code> objects. Each event loop is
the constellation&#39;s view of a script thread. The constellation
interacts with a script thread by message-passing.</p></li>
<li><p>The set of all <code>Pipeline</code> objects.  Each pipeline gives the
constellation&#39;s view of a <code>Window</code>, with its script thread and
layout threads.  Pipelines may share script threads, but not
layout threads.</p></li>
<li><p>The set of all <code>Frame</code> objects. Each frame gives the constellation&#39;s
view of a browsing context. Each browsing context stores an independent
session history, created by navigation of that frame. The session
history can be traversed, for example by the back and forwards UI,
so each session history maintains a list of past and future pipelines,
as well as the current active pipeline.</p></li>
</ul>

<p>There are two kinds of frames: top-level frames (for example tabs
in a browser UI), and nested frames (typically caused by <code>iframe</code>
elements). Frames have a hierarchy (typically caused by <code>iframe</code>s
containing <code>iframe</code>s), giving rise to a frame tree with a root frame.
The logical relationship between these types is:</p>

<pre class='rust rust-example-rendered'>
<span class='op'>+</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>+</span>              <span class='op'>+</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>+</span>                 <span class='op'>+</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>+</span>
<span class='op'>|</span>  <span class='ident'>Frame</span>  <span class='op'>|</span> <span class='op'>-</span><span class='op'>-</span><span class='ident'>parent</span><span class='question-mark'>?</span><span class='op'>-</span><span class='op'>-&gt;</span> <span class='op'>|</span>  <span class='ident'>Pipeline</span>  <span class='op'>|</span> <span class='op'>-</span><span class='op'>-</span><span class='ident'>event_loop</span><span class='op'>-</span><span class='op'>-&gt;</span> <span class='op'>|</span>  <span class='ident'>EventLoop</span>  <span class='op'>|</span>
<span class='op'>|</span>         <span class='op'>|</span> <span class='op'>-</span><span class='op'>-</span><span class='ident'>current</span><span class='op'>-</span><span class='op'>-&gt;</span> <span class='op'>|</span>            <span class='op'>|</span>                 <span class='op'>|</span>             <span class='op'>|</span>
<span class='op'>|</span>         <span class='op'>|</span> <span class='op'>-</span><span class='op'>-</span><span class='ident'>prev</span><span class='op'>*</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-&gt;</span> <span class='op'>|</span>            <span class='op'>|</span> &lt;-<span class='op'>-</span><span class='op'>-</span><span class='ident'>pipeline</span><span class='op'>*</span><span class='op'>-</span><span class='op'>-</span> <span class='op'>|</span>             <span class='op'>|</span>
<span class='op'>|</span>         <span class='op'>|</span> <span class='op'>-</span><span class='op'>-</span><span class='ident'>next</span><span class='op'>*</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-&gt;</span> <span class='op'>|</span>            <span class='op'>|</span>                 <span class='op'>+</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>+</span>
<span class='op'>|</span>         <span class='op'>|</span>              <span class='op'>|</span>            <span class='op'>|</span>
<span class='op'>|</span>         <span class='op'>|</span> &lt;-<span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='ident'>frame</span><span class='op'>-</span><span class='op'>-</span> <span class='op'>|</span>            <span class='op'>|</span>
<span class='op'>+</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>+</span>              <span class='op'>+</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>-</span><span class='op'>+</span></pre>

<p>Complicating matters, there are also mozbrowser iframes, which are top-level
frames with a parent.</p>

<p>The constellation also maintains channels to threads, including:</p>

<ul>
<li>The script and layout threads.</li>
<li>The graphics compositor.</li>
<li>The font cache, image cache, and resource manager, which load
and cache shared fonts, images, or other resources.</li>
<li>The service worker manager.</li>
<li>The devtools, debugger and webdriver servers.</li>
</ul>

<p>The constellation passes messages between the threads, and updates its state
to track the evolving state of the frame tree.</p>

<p>The constellation acts as a logger, tracking any <code>warn!</code> messages from threads,
and converting any <code>error!</code> or <code>panic!</code> into a crash report, which is filed
using an appropriate <code>mozbrowsererror</code> event.</p>

<p>Since there is only one constellation, and its responsibilities include crash reporting,
it is very important that it does not panic.</p>
</div><h2 id='structs' class='section-header'><a href="#structs">Structs</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.Constellation.html'
                                  title='constellation::constellation::Constellation'>Constellation</a></td>
                           <td class='docblock-short'>
                                <p>The <code>Constellation</code> itself. In the servo browser, there is one
constellation, which maintains all of the browser global data.
In embedded applications, there may be more than one constellation,
which are independent of each other.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.FromCompositorLogger.html'
                                  title='constellation::constellation::FromCompositorLogger'>FromCompositorLogger</a></td>
                           <td class='docblock-short'>
                                <p>A logger directed at the constellation from the compositor</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.FromScriptLogger.html'
                                  title='constellation::constellation::FromScriptLogger'>FromScriptLogger</a></td>
                           <td class='docblock-short'>
                                <p>The constellation uses logging to perform crash reporting.
The constellation receives all <code>warn!</code>, <code>error!</code> and <code>panic!</code> messages,
and generates a crash report when it receives a panic.
A logger directed at the constellation from content processes</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.InitialConstellationState.html'
                                  title='constellation::constellation::InitialConstellationState'>InitialConstellationState</a></td>
                           <td class='docblock-short'>
                                <p>State needed to construct a constellation.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='struct' href='struct.WebDriverData.html'
                                  title='constellation::constellation::WebDriverData'>WebDriverData</a></td>
                           <td class='docblock-short'>
                                <p>Data needed for webdriver</p>
                           </td>
                       </tr></table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='enum' href='enum.ExitPipelineMode.html'
                                  title='constellation::constellation::ExitPipelineMode'>ExitPipelineMode</a></td>
                           <td class='docblock-short'>
                                <p>When we are exiting a pipeline, we can either force exiting or not.
A normal exit waits for the compositor to update its state before
exiting, and delegates layout exit to script. A forced exit does
not notify the compositor, and exits layout without involving script.</p>
                           </td>
                       </tr>
                       <tr class=' module-item'>
                           <td><a class='enum' href='enum.ReadyToSave.html'
                                  title='constellation::constellation::ReadyToSave'>ReadyToSave</a></td>
                           <td class='docblock-short'>
                                <p>When we are running reftests, we save an image to compare against a reference.
This enum gives the possible states of preparing such an image.</p>
                           </td>
                       </tr></table><h2 id='constants' class='section-header'><a href="#constants">Constants</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='constant' href='constant.WARNINGS_BUFFER_SIZE.html'
                                  title='constellation::constellation::WARNINGS_BUFFER_SIZE'>WARNINGS_BUFFER_SIZE</a></td>
                           <td class='docblock-short'>
                                <p>The number of warnings to include in each crash report.</p>
                           </td>
                       </tr></table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                       <tr class=' module-item'>
                           <td><a class='fn' href='fn.log_entry.html'
                                  title='constellation::constellation::log_entry'>log_entry</a></td>
                           <td class='docblock-short'>
                                <p>Rust uses <code>LogRecord</code> for storing logging, but servo converts that to
a <code>LogEntry</code>. We do this so that we can record panics as well as log
messages, and because <code>LogRecord</code> does not implement serde (de)serialization,
so cannot be used over an IPC channel.</p>
                           </td>
                       </tr></table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                    <dt>+</dt>
                    <dd>Collapse/expand all sections</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../../";
        window.currentCrate = "constellation";
    </script>
    <script src="../../jquery.js"></script>
    <script src="../../main.js"></script>
    <script defer src="../../search-index.js"></script>
</body>
</html>